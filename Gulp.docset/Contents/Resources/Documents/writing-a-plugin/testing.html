<!DOCTYPE html>
<html lang="es">
<head>
	<title>testing</title>
    <meta charset="utf-8">
	<link rel="stylesheet" href="style.css" />
</head>
<body>
<h1>Testing</h1>

<blockquote>
  <p>Testing your plugin is the only way to ensure quality. It brings confidence to your users and makes your life easier.</p>
</blockquote>

<p><a href="README.md">Writing a Plugin</a> > Testing</p>

<h2>Tooling</h2>

<p>Most plugins use <a href="https://github.com/visionmedia/mocha">mocha</a> and <a href="https://github.com/dominictarr/event-stream">event-stream</a> to help them test. The following examples will use these tools.</p>

<h2>Testing plugins for streaming mode</h2>

<p>```js
var assert = require('assert');
var es = require('event-stream');
var File = require('vinyl');
var prefixer = require('../index');</p>

<p>describe('gulp-prefixer', function() {
  describe('in streaming mode', function() {</p>

<pre><code>it('should prepend text', function(done) {

  // create the fake file
  var fakeFile = new File({
    contents: es.readArray(['stream', 'with', 'those', 'contents'])
  });

  // Create a prefixer plugin stream
  var myPrefixer = prefixer('prependthis');

  // write the fake file to it
  myPrefixer.write(fakeFile);

  // wait for the file to come back out
  myPrefixer.once('data', function(file) {
    // make sure it came out the same way it went in
    assert(file.isStream());

    // buffer the contents to make sure it got prepended to
    file.contents.pipe(es.wait(function(err, data) {
      // check the contents
      assert.equal(data, 'prependthistostreamwiththosecontents');
      done();
    }));
  });

});
</code></pre>

<p>});
});
```</p>

<h2>Testing plugins for buffer mode</h2>

<p>```js
var assert = require('assert');
var es = require('event-stream');
var File = require('vinyl');
var prefixer = require('../index');</p>

<p>describe('gulp-prefixer', function() {
  describe('in buffer mode', function() {</p>

<pre><code>it('should prepend text', function(done) {

  // create the fake file
  var fakeFile = new File({
    contents: new Buffer('abufferwiththiscontent')
  });

  // Create a prefixer plugin stream
  var myPrefixer = prefixer('prependthis');

  // write the fake file to it
  myPrefixer.write(fakeFile);

  // wait for the file to come back out
  myPrefixer.once('data', function(file) {
    // make sure it came out the same way it went in
    assert(file.isBuffer());

    // check the contents
    assert.equal(file.contents.toString('utf8'), 'prependthisabufferwiththiscontent');
    done();
  });

});
</code></pre>

<p>});
});
```</p>

<h2>Sample tests</h2>

<ul>
<li><a href="https://github.com/ben-eb/gulp-cat/blob/master/test.js">gulp-cat</a></li>
</ul>
</body>
</html>
